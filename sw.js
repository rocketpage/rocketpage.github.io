const CACHE_VERSION=1,CURRENT_CACHE="main-1",cacheFiles=["/","/img/","/icons/"];self.addEventListener("activate",e=>e.waitUntil(caches.keys().then(e=>Promise.all(e.map(e=>{if("main-1"!==e)return caches.delete(e)}))))),self.addEventListener("install",e=>e.waitUntil(caches.open("main-1").then(e=>e.addAll(cacheFiles))));const fromNetwork=(e,t)=>new Promise((a,n)=>{const c=setTimeout(n,t);fetch(e).then(t=>{clearTimeout(c),a(t),update(e)},n)}),fromCache=e=>caches.open("main-1").then(t=>t.match(e).then(e=>e||t.match("/offline/"))),update=e=>caches.open("main-1").then(t=>fetch(e).then(a=>t.put(e,a)));self.addEventListener("fetch",e=>{e.respondWith(fromNetwork(e.request,1e4).catch(()=>fromCache(e.request))),e.waitUntil(update(e.request))});
